"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9955],{9955:(k,p,c)=>{c.r(p),c.d(p,{QuizPageModule:()=>j});var m=c(177),C=c(9417),d=c(7863),v=c(6336),g=c(467),P=c(3577),t=c(4438),_=c(5312),z=c(8058);let Q=(()=>{var e;class s{constructor(n){this.apiCtrl=n,this.url="/api/questionnaire/questionnaire_public",this.questionnaire=[],this.content_signature="",this.getContent()}checkCache(){var n=this;return(0,g.A)(function*(){let o=n.url,i=yield n.apiCtrl.checkCache(_.c.cache_key+o,null).catch(u=>{});return null!=i&&1==(null==i?void 0:i.status)&&"success"==(null==i?void 0:i.message)&&((null==i?void 0:i.signature)!=n.content_signature&&(n.questionnaire=[],i.data.map(u=>{n.questionnaire.push(u)}),n.content_signature=null==i?void 0:i.signature,console.log("new fresh data from cache")),!0)})()}checkServer(){var n=this;return(0,g.A)(function*(){let i,o=n.url;i=_.c.production?21600:5;let u=yield n.apiCtrl.getServer(o,!0,i).catch(a=>{});return null!=u&&"success"==(null==u?void 0:u.message)&&(u.signature!=n.content_signature&&(n.questionnaire=[],u.data.map(a=>{n.questionnaire.push(a)}),n.content_signature=u.signature,console.log("get new data dfrom server")),!0)})()}getContent(){var n=this;return(0,g.A)(function*(){let o=!1,i=yield n.checkCache();return i?n.checkServer():o=yield n.checkServer(),o||i})()}getQuestionnaire(){var n=this;return(0,g.A)(function*(){return yield n.getContent(),n.questionnaire})()}getQuestions(n){var o=this;return(0,g.A)(function*(){let i=[];return yield o.getContent(),o.questionnaire.find(a=>a.questionnaire_id==n).questionnaire_questions_obj.map(a=>{a.questions.map(l=>{i.push(l)})}),i.sort((a,l)=>a.questionnaire_question_id>l.questionnaire_question_id?1:a.questionnaire_question_id<l.questionnaire_question_id?-1:0),i})()}getAnswers(n,o){var i=this;return(0,g.A)(function*(){return yield i.getContent(),(yield i.getQuestions(n)).find(l=>l.questionnaire_question_id==o).answers})()}}return(e=s).\u0275fac=function(n){return new(n||e)(t.KVO(z.e))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();function M(e,s){if(1&e){const r=t.RV6();t.j41(0,"ion-item")(1,"ion-button",8),t.bIt("click",function(){const o=t.eBV(r).$implicit,i=t.XpG(2);return t.Njj(i.answerQuestion(o))}),t.nrm(2,"img",9),t.j41(3,"p",10),t.EFF(4),t.k0s()()()}if(2&e){const r=s.$implicit;t.R7$(4),t.JRh(r)}}function O(e,s){if(1&e&&(t.j41(0,"div",5)(1,"h2"),t.EFF(2),t.k0s(),t.j41(3,"ion-list",6),t.DNE(4,M,5,1,"ion-item",7),t.k0s()()),2&e){const r=t.XpG();t.R7$(2),t.JRh(r.questions[r.currentQuestionIndex].question),t.R7$(2),t.Y8G("ngForOf",r.questions[r.currentQuestionIndex].options)}}function y(e,s){if(1&e){const r=t.RV6();t.j41(0,"div",11)(1,"h2",12),t.EFF(2,"Kraj kviza!"),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s(),t.j41(5,"ion-item")(6,"ion-button",8),t.bIt("click",function(){t.eBV(r);const o=t.XpG();return t.Njj(o.restartQuiz())}),t.nrm(7,"img",9),t.j41(8,"p",10),t.EFF(9,"IGRAJ PONOVNO"),t.k0s()()()()}if(2&e){const r=t.XpG();t.R7$(4),t.Lme("Va\u0161 rezultat: ",r.score,"/",r.questions.length,"")}}let q=(()=>{var e;class s{constructor(n){this.questionCtrl=n,this.questions=[],this.currentQuestionIndex=0,this.questionnaireName="",this.score=0,this.quizOver=!1}ngOnInit(){this.loadQuizData()}loadQuizData(){var n=this;return(0,g.A)(function*(){try{const o=yield n.questionCtrl.getQuestionnaire();if(!o||0===o.length)return void console.error("No questionnaires found.");const i=o[0].questionnaire_id;n.questionnaireName=o[0].questionnaire_name;const u=yield n.questionCtrl.getQuestions(i);n.questions=yield Promise.all(u.map(function(){var a=(0,g.A)(function*(l){var h;const x=yield n.questionCtrl.getAnswers(i,l.questionnaire_question_id);return{question:l.questionnaire_question_text,options:x.map(f=>String(f.questionnaire_answer_text)),answer:String((null===(h=x.find(f=>"Y"===f.questionnaire_answer_correct))||void 0===h?void 0:h.questionnaire_answer_text)||"")}});return function(l){return a.apply(this,arguments)}}())),console.log("Formatted Questions: ",n.questions)}catch(o){console.error("Error loading quiz data:",o)}})()}answerQuestion(n){n===this.questions[this.currentQuestionIndex].answer&&this.score++,this.currentQuestionIndex++,this.currentQuestionIndex>=this.questions.length&&(this.quizOver=!0)}restartQuiz(){this.currentQuestionIndex=0,this.score=0,this.quizOver=!1}}return(e=s).\u0275fac=function(n){return new(n||e)(t.rXU(Q))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-quiz"]],decls:9,vars:3,consts:[[1,"ion-padding"],["src","assets/menu.png","alt","menu icon",1,"menu-button"],[1,"game-container"],["class","question-container",4,"ngIf"],["class","quiz-over",4,"ngIf"],[1,"question-container"],["lines","none"],[4,"ngFor","ngForOf"],[1,"option-button",3,"click"],["src","assets/menu.png","alt","menu icon",1,"card-image"],[1,"option-text"],[1,"quiz-over"],[1,"quiz-over-title"]],template:function(n,o){1&n&&(t.j41(0,"ion-content",0)(1,"ion-menu-button"),t.nrm(2,"img",1),t.k0s(),t.nrm(3,"app-back-button"),t.j41(4,"div",2)(5,"h1"),t.EFF(6),t.k0s(),t.DNE(7,O,5,2,"div",3)(8,y,10,2,"div",4),t.k0s()()),2&n&&(t.R7$(6),t.JRh(o.questionnaireName),t.R7$(),t.Y8G("ngIf",o.questions.length>0&&!o.quizOver),t.R7$(),t.Y8G("ngIf",o.quizOver))},dependencies:[d.bv,d.Jm,d.W9,d.uz,d.nf,d.MC,m.MD,m.Sq,m.bT,P.X],styles:["ion-content[_ngcontent-%COMP%]{--background: url(/assets/app-naslovna.jpg) 0 0/100% 100% no-repeat}.game-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:50px 50px 0 0;width:100%;max-height:70vh;display:flex;justify-content:flex-start;align-items:center;flex-direction:column;z-index:1;overflow-y:auto;position:absolute;bottom:0;right:0;padding:2rem 3rem 10rem;box-shadow:0 -5px 15px #000000bf}h1[_ngcontent-%COMP%]{font-size:2rem;color:#a3622a;font-weight:900}.quiz-over-title[_ngcontent-%COMP%]{font-size:2rem;color:#a3622a;font-weight:900;text-align:center}.question-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;padding-bottom:6rem}h2[_ngcontent-%COMP%]{font-size:1.1rem;width:90%;margin:0 auto;padding-bottom:2rem}ion-button[_ngcontent-%COMP%], ion-card[_ngcontent-%COMP%]{width:80vmin;height:10vmin;margin:.5rem;display:flex;justify-content:flex-start;align-items:center;--background: #a3622a;--color: white;font-size:1rem;font-weight:900;--box-shadow: none}.quiz-over[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%}.card-image[_ngcontent-%COMP%]{width:15%;padding-top:.7rem;background-color:#7f460d;position:absolute;left:-.5rem}p[_ngcontent-%COMP%], .play-again[_ngcontent-%COMP%]{margin-left:3rem;flex-grow:1;text-align:left;text-transform:none}.option-text[_ngcontent-%COMP%], .play-again[_ngcontent-%COMP%]{font-size:1rem}.play-again[_ngcontent-%COMP%]{text-indent:4rem}.option-button[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;flex-direction:column;text-align:right}.menu-button[_ngcontent-%COMP%]{background-color:transparent;max-width:20vmin;margin:auto;position:absolute;top:65%;left:45%;transform:translate(-50%,-50%)}ion-menu-button[_ngcontent-%COMP%]{position:absolute;top:3rem;right:1rem;height:18vmin;width:20%;--background: #a3612c;--border-radius: 50%}@media (min-width: 360px){h2[_ngcontent-%COMP%]{font-size:1rem}ion-menu-button[_ngcontent-%COMP%]{position:absolute;top:3rem;right:1rem}}@media (min-width: 360px){.container[_ngcontent-%COMP%]{padding:0rem 3rem 6rem;font-size:.8rem}.img[_ngcontent-%COMP%]{max-width:100%;height:50vmin}ion-menu-button[_ngcontent-%COMP%]{position:absolute;top:3rem;right:1rem}}@media (min-width: 800px){ion-menu-button[_ngcontent-%COMP%]{position:absolute;top:3rem;right:2rem;height:16vmin;width:18%}option-text[_ngcontent-%COMP%]{font-size:1rem}.play-again[_ngcontent-%COMP%]{text-indent:8rem}}@media (min-width: 1024px){ion-menu-button[_ngcontent-%COMP%]{position:absolute;top:3rem;right:8rem;height:16vmin;width:18%}.play-again[_ngcontent-%COMP%]{text-indent:10rem}option-text[_ngcontent-%COMP%]{font-size:3rem;text-align:center}ion-button[_ngcontent-%COMP%]{width:30vmin}}"]}),s})();const b=[{path:"",component:q}];let w=(()=>{var e;class s{}return(e=s).\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[v.iI.forChild(b),v.iI]}),s})(),j=(()=>{var e;class s{}return(e=s).\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[m.MD,C.YN,d.bv,w,q]}),s})()}}]);